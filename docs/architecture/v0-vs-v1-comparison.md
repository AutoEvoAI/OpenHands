# OpenHands V0 ä¸ V1 æ¶æ„å…¨é¢å¯¹æ¯”åˆ†ææŠ¥å‘Š

## ä¸€ã€æ¦‚è¿°

OpenHands æ­£åœ¨ç»å†ä» V0 åˆ° V1 çš„å¤§ç‰ˆæœ¬å‡çº§ã€‚V1 ç‰ˆæœ¬è®¡åˆ’äº **2026å¹´4æœˆ1æ—¥** å®Œæˆè¿ç§»å¹¶ç§»é™¤ V0 ä»£ç ã€‚


| ç»´åº¦   | V0 (Legacy)                   | V1 (New)           |
| ---- | ----------------------------- | ------------------ |
| ä»£ç çŠ¶æ€ | å·²æ ‡è®°åºŸå¼ƒ                         | å¼€å‘ä¸­                |
| æ ¸å¿ƒæ¶æ„ | AgentController + EventStream | Software Agent SDK |
| å­˜å‚¨   | æ–‡ä»¶ç³»ç»Ÿä¸ºä¸»                        | æ•°æ®åº“ (SQL)          |
| è¿è¡Œæ—¶  | å†…åµŒå¼ Runtime                   | æ²™ç®±éš”ç¦» (Sandbox)     |
| API  | `/api/conversations/`*        | `/api/v1/*`        |
| å‰ç«¯æ”¯æŒ | å®Œæ•´                            | éƒ¨åˆ†åŠŸèƒ½               |


---

## äºŒã€æ¶æ„è®¾è®¡ä¼˜åŒ–å¯¹æ¯”

### 2.1 æ ¸å¿ƒæ¶æ„å˜åŒ–

#### V0 æ¶æ„ (å•ä½“æ¶æ„)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         V0 æ¶æ„                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  FastAPI â”‚â”€â”€â”€â”€â–¶â”‚ AgentSessionâ”‚â”€â”€â”€â”€â–¶â”‚AgentController   â”‚  â”‚
â”‚   â”‚  Server  â”‚     â”‚             â”‚     â”‚                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚                                          â”‚    â”‚  Agent  â”‚  â”‚  â”‚
â”‚                                          â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚         â”‚        â”‚  â”‚
â”‚   â”‚  Runtime â”‚â—€â”€â”€â”€â”€â”‚EventStream  â”‚â—€â”€â”€â”€â”€â”‚    LLM  â”‚        â”‚  â”‚
â”‚   â”‚(Docker)  â”‚     â”‚             â”‚     â”‚         â”‚        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚                                                                  â”‚
â”‚   é—®é¢˜:                                                          â”‚
â”‚   - Runtime ä¸ Server ç´§è€¦åˆ                                     â”‚
â”‚   - å•ä½“æ¶æ„éš¾ä»¥æ‰©å±•                                             â”‚
â”‚   - EventStream æˆä¸ºæ€§èƒ½ç“¶é¢ˆ                                     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### V1 æ¶æ„ (å¾®æœåŠ¡æ¶æ„)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         V1 æ¶æ„                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                    API Gateway (FastAPI)                  â”‚ â”‚
â”‚   â”‚                  /api/v1/*                                â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                â”‚                                â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚        â”‚                       â”‚                       â”‚       â”‚
â”‚        â–¼                       â–¼                       â–¼       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚Conversationâ”‚         â”‚  Event   â”‚          â”‚ Sandbox  â”‚    â”‚
â”‚  â”‚  Service  â”‚          â”‚  Service â”‚          â”‚ Service  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â”‚
â”‚       â”‚                     â”‚                     â”‚           â”‚
â”‚       â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚           â”‚
â”‚       â”‚            â”‚                 â”‚            â”‚           â”‚
â”‚       â–¼            â–¼                 â–¼            â–¼           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  SQL   â”‚  â”‚  Event â”‚       â”‚Agent   â”‚  â”‚ Docker â”‚       â”‚
â”‚  â”‚Database â”‚  â”‚ Store  â”‚       â”‚ Server â”‚  â”‚Sandbox â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                 â”‚
â”‚  æ”¹è¿›:                                                          â”‚
â”‚  - æœåŠ¡è§£è€¦ï¼Œæ¯ä¸ªæœåŠ¡ç‹¬ç«‹æ‰©å±•                                     â”‚
â”‚  - æ•°æ®åº“å­˜å‚¨ï¼Œæ”¯æŒäº‹åŠ¡                                         â”‚
â”‚  - æ²™ç®±éš”ç¦»ï¼Œå®‰å…¨å¯é                                            â”‚
â”‚  - Agent Server ç‹¬ç«‹è¿è¡Œ                                        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å­˜å‚¨å±‚ä¼˜åŒ–


| ç‰¹æ€§               | V0                      | V1                             |
| ---------------- | ----------------------- | ------------------------------ |
| **å­˜å‚¨æ–¹å¼**         | æ–‡ä»¶ç³»ç»Ÿ (JSON)             | SQLæ•°æ®åº“                         |
| **Conversation** | `FileConversationStore` | `AppConversationService` + SQL |
| **Settings**     | `FileSettingsStore`     | æ•°æ®åº“è¡¨                           |
| **Secrets**      | `FileSecretsStore`      | åŠ å¯†å­˜å‚¨                           |
| **äº‹ä»¶å­˜å‚¨**         | å†…å­˜ + æ–‡ä»¶                 | `EventStore` + æ•°æ®åº“             |
| **ä¼˜åŠ¿**           | ç®€å•                      | äº‹åŠ¡æ”¯æŒã€å¹¶å‘ã€å®‰å…¨                     |


**V1 å­˜å‚¨æ”¹è¿›ç‚¹:**

- ä½¿ç”¨ SQLAlchemy å¼‚æ­¥ ORM
- æ”¯æŒæ•°æ®åº“è¿ç§» (Alembic)
- åŠ å¯†æ•æ„Ÿä¿¡æ¯
- åˆ†é¡µæŸ¥è¯¢æ”¯æŒ

### 2.3 è¿è¡Œæ—¶ç¯å¢ƒ (Runtime vs Sandbox)

#### V0: Runtime å†…åµŒæ¨¡å¼

```python
# V0: Runtime ç›´æ¥è¿è¡Œåœ¨ä¸»è¿›ç¨‹/å®¹å™¨ä¸­
class AgentController:
    def __init__(self):
        self.runtime = get_runtime_cls(config)()  # ç›´æ¥åˆ›å»º
        self.agent = CodeActAgent(config)
        self.event_stream = EventStream()
```

**é—®é¢˜:**

- Runtime ä¸ Server ç”Ÿå‘½å‘¨æœŸç»‘å®š
- èµ„æºéš”ç¦»å·®
- éš¾ä»¥æ°´å¹³æ‰©å±•

#### V1: Sandbox éš”ç¦»æ¨¡å¼

```python
# V1: Sandbox ä½œä¸ºç‹¬ç«‹æœåŠ¡
class SandboxService(ABC):
    async def start_sandbox(self, spec_id: str) -> SandboxInfo:
        """å¯åŠ¨ç‹¬ç«‹çš„æ²™ç®±ç¯å¢ƒ"""
        
    async def get_sandbox(self, sandbox_id: str) -> SandboxInfo:
        """è·å–æ²™ç®±çŠ¶æ€"""
```

**V1 Sandbox ä¼˜åŠ¿:**


| ç‰¹æ€§   | V0 Runtime | V1 Sandbox |
| ---- | ---------- | ---------- |
| éš”ç¦»æ€§  | è¿›ç¨‹çº§        | å®¹å™¨çº§        |
| æ‰©å±•æ€§  | å·®          | å¥½ (K8s)    |
| èµ„æºæ§åˆ¶ | æœ‰é™         | å®Œå–„         |
| å¯åŠ¨é€Ÿåº¦ | å¿«          | å¯é…ç½®        |
| çŠ¶æ€ä¿æŒ | å†…å­˜         | æŒä¹…åŒ–        |


### 2.4 äº‹ä»¶ç³»ç»Ÿä¼˜åŒ–

#### V0 EventStream

```python
# V0: å†…å­˜äº‹ä»¶æµ
class EventStream:
    def __init__(self):
        self.events: list[Event] = []
        self.subscribers: dict = {}
    
    def add_event(self, event):
        self.events.append(event)
        for subscriber in self.subscribers.values():
            subscriber.notify(event)
```

**é—®é¢˜:**

- å†…å­˜å—é™ï¼Œäº‹ä»¶å¤šæ—¶æ€§èƒ½ä¸‹é™
- ä¸æ”¯æŒåˆ†é¡µ
- æ— æŒä¹…åŒ–

#### V1 Event Service

```python
# V1: æ•°æ®åº“äº‹ä»¶æœåŠ¡
class EventService(ABC):
    async def search_events(
        self,
        conversation_id: UUID,
        kind__eq: EventKind | None = None,
        timestamp__gte: datetime | None = None,
        page_id: str | None = None,
        limit: int = 100,
    ) -> EventPage:
        """åˆ†é¡µæŸ¥è¯¢äº‹ä»¶"""
```

**V1 æ”¹è¿›:**

- æ•°æ®åº“æŒä¹…åŒ–
- åˆ†é¡µæŸ¥è¯¢
- äº‹ä»¶ç±»å‹è¿‡æ»¤
- æ—¶é—´èŒƒå›´æŸ¥è¯¢

---

## ä¸‰ã€API è®¾è®¡å¯¹æ¯”

### 3.1 API ç«¯ç‚¹å¯¹æ¯”

#### V0 API

```python
# openhands/server/routes/
/api/conversations                    # åˆ›å»ºä¼šè¯
/api/conversations/{id}/start         # å¯åŠ¨ä¼šè¯
/api/conversations/{id}/send         # å‘é€æ¶ˆæ¯
/api/conversations/{id}/events       # è·å–äº‹ä»¶
/api/conversations/{id}/stop         # åœæ­¢ä¼šè¯
/api/conversations/{id}/trajectory   # è·å–è½¨è¿¹
```

#### V1 API

```python
# openhands/app_server/
/api/v1/app-conversations                    # ä¼šè¯ç®¡ç†
/api/v1/app-conversations/search             # æœç´¢ä¼šè¯
/api/v1/app-conversations/{id}/start-tasks  # å¯åŠ¨ä»»åŠ¡
/api/v1/events                              # äº‹ä»¶ç®¡ç†
/api/v1/sandbox                             # æ²™ç®±ç®¡ç†
/api/v1/sandbox-spec                        # æ²™ç®±è§„æ ¼
```

### 3.2 æ•°æ®æ¨¡å‹å¯¹æ¯”

#### V0 Conversation Metadata

```python
# V0: ç®€å•æ–‡ä»¶å­˜å‚¨
class ConversationMetadata(BaseModel):
    conversation_id: str
    title: str
    user_id: str | None
    selected_repository: str | None
    trigger: ConversationTrigger
    # ç®€å•å­—æ®µï¼Œæ— å¤æ‚å…³ç³»
```

#### V1 App Conversation

```python
# V1: å®Œæ•´çš„å…³ç³»æ¨¡å‹
class AppConversationInfo(BaseModel):
    id: OpenHandsUUID
    sandbox_id: str
    selected_repository: str | None
    selected_branch: str | None
    git_provider: ProviderType | None
    title: str | None
    metrics: MetricsSnapshot | None
    parent_conversation_id: OpenHandsUUID | None
    sub_conversation_ids: list[OpenHandsUUID]
    created_at: datetime
    updated_at: datetime
    # æ”¯æŒçˆ¶å­ä¼šè¯å…³ç³»
    # æ”¯æŒæŒ‡æ ‡è¿½è¸ª
```

---

## å››ã€å‰ç«¯äº‹ä»¶å¤„ç†å¯¹æ¯”

### 4.1 äº‹ä»¶ç±»å‹

#### V0 äº‹ä»¶ (Python å¯¹è±¡åºåˆ—åŒ–)

```typescript
// V0: Python å¯¹è±¡ç›´æ¥åºåˆ—åŒ–
interface V0Action {
  id: string;
  action: string;
  content: string;
}
```

#### V1 äº‹ä»¶ (ç»“æ„åŒ– TypeScript ç±»å‹)

```typescript
// V1: å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
interface ActionEvent<T extends Action> extends BaseEvent {
  thought: TextContent[];           // Agent æ€è€ƒè¿‡ç¨‹
  reasoning_content?: string;       // æ¨ç†å†…å®¹
  thinking_blocks: ThinkingBlock[];  // æ€ç»´å— (Anthropic)
  action: T;                         // å…·ä½“åŠ¨ä½œ
  tool_name: string;                 // å·¥å…·åç§°
  tool_call_id: ToolCallID;         // å·¥å…·è°ƒç”¨ID
  security_risk: SecurityRisk;       // å®‰å…¨é£é™©è¯„ä¼°
}
```

### 4.2 å®‰å…¨é£é™©è¯„ä¼°

#### V0: æœ‰é™çš„å®‰å…¨æ£€æŸ¥

```python
# V0: åŸºç¡€å®‰å…¨åˆ†æ
if self.security_analyzer:
    action.security_risk = await self.security_analyzer.security_risk(action)
```

#### V1: ç»“æ„åŒ–å®‰å…¨é£é™©

```typescript
// V1: å®Œæ•´çš„å®‰å…¨é£é™©è¯„ä¼°
interface SecurityRisk {
  level: 'LOW' | 'MEDIUM' | 'HIGH' | 'UNKNOWN';
  reason?: string;
  confirmed_by_user?: boolean;
}
```

---

## äº”ã€æ€§èƒ½ä¸å¯æ‰©å±•æ€§

### 5.1 æ€§èƒ½å¯¹æ¯”


| æŒ‡æ ‡       | V0      | V1           | æ”¹è¿›            |
| -------- | ------- | ------------ | ------------- |
| **æ°´å¹³æ‰©å±•** | å›°éš¾      | å®¹æ˜“           | Sandbox å¯ç‹¬ç«‹æ‰©å±• |
| **äº‹ä»¶æŸ¥è¯¢** | O(n) å†…å­˜ | O(log n) ç´¢å¼•  | åˆ†é¡µ + ç´¢å¼•       |
| **å­˜å‚¨æ‰©å±•** | æ–‡ä»¶ç³»ç»Ÿ    | æ•°æ®åº“          | äº‹åŠ¡ + ç´¢å¼•       |
| **å¹¶å‘æ”¯æŒ** | å—é™äºå†…å­˜   | æ•°æ®åº“å¹¶å‘        | ACID äº‹åŠ¡       |
| **å†·å¯åŠ¨**  | å¿«       | ç¨æ…¢ (Sandbox) | å®¹å™¨å¤ç”¨          |


### 5.2 å¯æ‰©å±•æ€§æ”¹è¿›

#### V0 æ‰©å±•é™åˆ¶

```
V0 æ‰©å±•æ€§ç—›ç‚¹:
â”œâ”€â”€ å•ä½“æ¶æ„ â†’ éš¾ä»¥å¢åŠ æ–°åŠŸèƒ½
â”œâ”€â”€ æ–‡ä»¶å­˜å‚¨ â†’ éš¾ä»¥æ”¯æŒå¤šç”¨æˆ·
â”œâ”€â”€ å†…å­˜äº‹ä»¶ â†’ éš¾ä»¥å¤„ç†é•¿å¯¹è¯
â””â”€â”€ å†…åµŒ Runtime â†’ éš¾ä»¥è¿œç¨‹éƒ¨ç½²
```

#### V1 æ‰©å±•è®¾è®¡

```
V1 æ‰©å±•æ€§ä¼˜åŠ¿:
â”œâ”€â”€ å¾®æœåŠ¡æ¶æ„ â†’ ç‹¬ç«‹æ‰©å±•å„æœåŠ¡
â”œâ”€â”€ æ•°æ®åº“å­˜å‚¨ â†’ æ”¯æŒå¤§è§„æ¨¡æ•°æ®
â”œâ”€â”€ Sandbox éš”ç¦» â†’ å¯éƒ¨ç½²åˆ° K8s
â”œâ”€â”€ Event Service â†’ æ”¯æŒé«˜é¢‘äº‹ä»¶
â””â”€â”€ Agent Server â†’ ç‹¬ç«‹æ‰©ç¼©å®¹
```

---

## å…­ã€åŠŸèƒ½ç‰¹æ€§å¯¹æ¯”

### 6.1 åŠŸèƒ½çŸ©é˜µ


| åŠŸèƒ½           | V0  | V1       | è¯´æ˜                      |
| ------------ | --- | -------- | ----------------------- |
| **åŸºæœ¬å¯¹è¯**     | âœ…   | âœ…        |                         |
| **ä»£ç æ‰§è¡Œ**     | âœ…   | âœ…        |                         |
| **æµè§ˆå™¨        | âœ…   |          |                         |
| äº¤äº’**         | âœ…   | **æ–‡ä»¶ç¼–è¾‘** | âœ…                       |
| **Agent å§”æ‰˜** | âœ…   | âœ…        |                         |
| **çˆ¶å­ä¼šè¯**     | âŒ   | âœ…        | V1 æ”¯æŒ sub-conversations |
| **ä»»åŠ¡è¿½è¸ª**     | âœ…   | âœ…        |                         |
| **å†å²å‹ç¼©**     | âœ…   | âœ…        |                         |
| **æŒ‡æ ‡è¿½è¸ª**     | ç®€å•  | å®Œæ•´       | V1 æœ‰ MetricsSnapshot    |
| **Webhooks** | åŸºç¡€  | å®Œæ•´       | V1 äº‹ä»¶å›è°ƒ                 |
| **æ•°æ®åº“å­˜å‚¨**    | âŒ   | âœ…        |                         |
| **æ²™ç®±éš”ç¦»**     | åŸºç¡€  | å®Œæ•´       | Docker/K8s              |
| **æŠ€èƒ½åŠ è½½**     | é™æ€  | åŠ¨æ€       | V1 PluginSpec           |


### 6.2 V1 æ–°å¢åŠŸèƒ½

#### 1. æŠ€èƒ½åŠ è½½ (Skills)

```python
# V1: åŠ¨æ€æŠ€èƒ½åŠ è½½
class PluginSpec(PluginSource):
    """Specification for loading a plugin into a conversation."""
    source: str          # github:owner/repo
    ref: str            # branch/tag
    parameters: dict    # ç”¨æˆ·é…ç½®çš„å‚æ•°
```

#### 2. çˆ¶å­ä¼šè¯ (Sub-conversations)

```python
# V1: æ”¯æŒ Plan æ¨¡å¼
class AppConversationInfo(BaseModel):
    parent_conversation_id: OpenHandsUUID | None
    sub_conversation_ids: list[OpenHandsUUID]
```

#### 3. äº‹ä»¶å›è°ƒ (Event Callbacks)

```python
# V1: Webhook å›è°ƒ
class EventCallbackProcessor:
    async def process(self, event: Event):
        # ä»»åŠ¡å¼€å§‹/ç»“æŸæ—¶çš„å›è°ƒ
        # æ ‡é¢˜æ›´æ–°
        # è‡ªå®šä¹‰ Webhook
```

---

## ä¸ƒã€è¿ç§»è¿›åº¦ä¸ç°çŠ¶

### 7.1 ä»£ç åˆ†å¸ƒ

```
OpenHands ä»“åº“ç»“æ„:
â”œâ”€â”€ openhands/                    # ä¸»ä»“åº“ (V0 + V1 App Server)
â”‚   â”œâ”€â”€ server/                   # V0 ä»£ç  (çº¦ 550+ æ–‡ä»¶æ ‡è®°ä¸º LEGACY V0)
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ session/
â”‚   â”‚   â”œâ”€â”€ conversation_manager/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ app_server/               # V1 App Server (å·²å®ç°)
â”‚   â”‚   â”œâ”€â”€ app_conversation/     # ä¼šè¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ event/                # äº‹ä»¶æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ sandbox/              # æ²™ç®±æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ user/                 # ç”¨æˆ·æœåŠ¡
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ frontend/src/
â”‚       â”œâ”€â”€ api/                 # åŒæ—¶æ”¯æŒ V0/V1
â”‚       â”œâ”€â”€ hooks/               # åŒæ—¶æ”¯æŒ V0/V1
â”‚       â””â”€â”€ types/               # V0/V1 ç±»å‹å®šä¹‰
â”‚
â”œâ”€â”€ software-agent-sdk/           # V1 Agent SDK (ç‹¬ç«‹ä»“åº“)
â”‚   â”œâ”€â”€ openhands-sdk/           # æ ¸å¿ƒ SDK
â”‚   â”‚   â”œâ”€â”€ agent/               # Agent å®ç°
â”‚   â”‚   â”œâ”€â”€ llm/                 # LLM è°ƒç”¨
â”‚   â”‚   â”œâ”€â”€ event/               # äº‹ä»¶ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ tool/                # å·¥å…·åŸºç±»
â”‚   â”‚   â”œâ”€â”€ conversation/        # å¯¹è¯ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ hooks/               # é’©å­ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ mcp/                 # MCP å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ plugin/              # æ’ä»¶ç³»ç»Ÿ
â”‚   â”‚
â”‚   â”œâ”€â”€ openhands-tools/         # å†…ç½®å·¥å…·
â”‚   â”‚   â”œâ”€â”€ terminal/            # ç»ˆç«¯å·¥å…·
â”‚   â”‚   â”œâ”€â”€ file_editor/         # æ–‡ä»¶ç¼–è¾‘
â”‚   â”‚   â”œâ”€â”€ browser_use/         # æµè§ˆå™¨
â”‚   â”‚   â”œâ”€â”€ task_tracker/        # ä»»åŠ¡è·Ÿè¸ª
â”‚   â”‚   â”œâ”€â”€ delegate/            # Agentå§”æ‰˜
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ openhands-agent-server/  # Agent æœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ conversation_service # ä¼šè¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ event_router         # äº‹ä»¶è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ tool_router          # å·¥å…·è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ skills_service       # æŠ€èƒ½æœåŠ¡
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ openhands-workspace/     # å·¥ä½œç©ºé—´
â”‚       â”œâ”€â”€ local/              # æœ¬åœ°å·¥ä½œç©ºé—´
â”‚       â”œâ”€â”€ remote/             # è¿œç¨‹å·¥ä½œç©ºé—´
â”‚       â””â”€â”€ cloud/              # äº‘ç«¯å·¥ä½œç©ºé—´
```

### 7.2 V1 (Software Agent SDK) å®Œæˆè¿›åº¦

#### æ ¸å¿ƒæ¨¡å—å®Œæˆåº¦

| æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| **openhands-sdk** | ğŸŸ¢ æˆç†Ÿ | å®Œæ•´çš„Agentã€LLMã€Eventã€Toolæ ¸å¿ƒ |
| **openhands-tools** | ğŸŸ¢ æˆç†Ÿ | Terminalã€FileEditorã€Browserã€TaskTrackerç­‰ |
| **openhands-agent-server** | ğŸŸ¢ æˆç†Ÿ | å®Œæ•´çš„æœåŠ¡å™¨å®ç° |
| **openhands-workspace** | ğŸŸ¢ æˆç†Ÿ | Local/Remote/Cloudå·¥ä½œç©ºé—´ |

#### V1 SDK æ ¸å¿ƒåŠŸèƒ½

```python
# V1 SDK ä½¿ç”¨ç¤ºä¾‹ (å·²å®Œæ•´å®ç°)
from openhands.sdk import Agent, LLM, Tool
from openhands.sdk.llm import Message, TextContent
from openhands.sdk.tool import Action, Observation
from openhands.sdk.conversation import Conversation, LocalConversation

# 1. åˆ›å»º LLM
llm = LLM(model="claude-sonnet-4-20250514")

# 2. åˆ›å»ºå·¥å…·
tools = [TerminalTool(), FileEditorTool()]

# 3. åˆ›å»º Agent
agent = Agent(llm=llm, tools=tools)

# 4. åˆ›å»ºå¯¹è¯å¹¶è¿è¡Œ
conversation = LocalConversation(agent=agent)
result = await conversation.run(user_message="å¸®æˆ‘å†™ä¸ª hello world")
```

#### V1 Agent æ¶æ„

```
openhands-sdk/openhands/sdk/agent/
â”œâ”€â”€ agent.py          # Agent ä¸»ç±» (CriticMixin, AgentBase)
â”œâ”€â”€ base.py           # Agent åŸºç±»
â”œâ”€â”€ critic_mixin.py   # Critic è¯„ä¼°æ··åˆ
â””â”€â”€ utils.py          # å·¥å…·å‡½æ•°
```

#### V1 Event ç³»ç»Ÿ

```
openhands-sdk/openhands/sdk/event/
â”œâ”€â”€ base.py                    # äº‹ä»¶åŸºç±»
â”œâ”€â”€ action_event.py            # Action äº‹ä»¶
â”œâ”€â”€ observation_event.py       # Observation äº‹ä»¶
â”œâ”€â”€ message_event.py           # æ¶ˆæ¯äº‹ä»¶
â”œâ”€â”€ conversation_state.py       # å¯¹è¯çŠ¶æ€äº‹ä»¶
â”œâ”€â”€ condenser.py               # å†å²å‹ç¼©
â”œâ”€â”€ llm_convertible/          # LLM å¯è½¬æ¢äº‹ä»¶
â”‚   â”œâ”€â”€ action.py
â”‚   â”œâ”€â”€ observation.py
â”‚   â””â”€â”€ message.py
â””â”€â”€ types.py                  # ç±»å‹å®šä¹‰
```

#### V1 å·¥å…·ç³»ç»Ÿ

```
openhands-tools/openhands/tools/
â”œâ”€â”€ __init__.py               # å…¬å…±å¯¼å‡º
â”œâ”€â”€ terminal/                 # ç»ˆç«¯å·¥å…·
â”‚   â”œâ”€â”€ definition.py         # å·¥å…·å®šä¹‰
â”‚   â”œâ”€â”€ impl.py              # å®ç°
â”‚   â””â”€â”€ terminal/            # ç»ˆç«¯ä¼šè¯
â”œâ”€â”€ file_editor/             # æ–‡ä»¶ç¼–è¾‘
â”‚   â”œâ”€â”€ definition.py
â”‚   â”œâ”€â”€ impl.py
â”‚   â””â”€â”€ editor.py
â”œâ”€â”€ browser_use/             # æµè§ˆå™¨
â”œâ”€â”€ task_tracker/            # ä»»åŠ¡è·Ÿè¸ª
â”œâ”€â”€ delegate/                # Agent å§”æ‰˜
â”œâ”€â”€ planning_file_editor/    # è§„åˆ’æ¨¡å¼æ–‡ä»¶ç¼–è¾‘
â”œâ”€â”€ task/                    # ä»»åŠ¡ç®¡ç†
â”œâ”€â”€ glob/                    # æ–‡ä»¶æœç´¢
â”œâ”€â”€ grep/                    # å†…å®¹æœç´¢
â””â”€â”€ preset/                  # é¢„è®¾å·¥å…·é›†
```

### 7.3 å¼€å…³æ§åˆ¶

```python
# åç«¯å¼€å…³
# openhands/server/config/server_config.py
enable_v1: bool = os.getenv('ENABLE_V1') != '0'  # é»˜è®¤å¼€å¯

# å‰ç«¯å¼€å…³
# frontend/src/services/settings.ts
v1_enabled: false  # é»˜è®¤å…³é—­

# è¿è¡Œæ—¶åˆ‡æ¢
if settings.v1_enabled:
    # ä½¿ç”¨ V1 API
else:
    # ä½¿ç”¨ V0 API
```

### 7.3 è¿‡æ¸¡ç­–ç•¥

```
å½“å‰çŠ¶æ€: V0/V1 å…±å­˜

V0 â†’ V1 è¿ç§»è·¯å¾„:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 1: V1 åŸºç¡€æ¡†æ¶æ­å»º (å·²å®Œæˆ) âœ…                        â”‚
â”‚   - software-agent-sdk ä»“åº“å»ºç«‹                            â”‚
â”‚   - SDK æ ¸å¿ƒæ¨¡å—å®Œæˆ (agent, llm, event, tool)            â”‚
â”‚   - Agent Server å®Œæˆ                                      â”‚
â”‚   - å·¥å…·é›†å®Œæˆ (terminal, file_editor, browser, etc)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 2: V1 App Server é›†æˆ (å·²å®Œæˆ) âœ…                    â”‚
â”‚   - app_server ç›®å½•ç»“æ„                                    â”‚
â”‚   - æ•°æ®åº“æ¨¡å‹                                             â”‚
â”‚   - Sandbox æœåŠ¡                                           â”‚
â”‚   - ä¸ OpenHands ä¸»ä»“åº“é›†æˆ                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 3: å‰åç«¯é€‚é… (è¿›è¡Œä¸­) ğŸ”„                           â”‚
â”‚   - å‰ç«¯ V1 API é€‚é…                                      â”‚
â”‚   - äº‹ä»¶ç±»å‹é€‚é…                                           â”‚
â”‚   - WebSocket é€‚é…                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 4: V0 ç§»é™¤ (è®¡åˆ’ 2026-04)                          â”‚
â”‚   - åˆ é™¤ server/ ç›®å½•                                     â”‚
â”‚   - æ¸…ç† V0 ç›¸å…³ä»£ç                                        â”‚
â”‚   - å…¨é¢åˆ‡æ¢åˆ° V1                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.4 V1 ä¸ OpenHands ä¸»ä»“åº“é›†æˆçŠ¶æ€

| ç»„ä»¶ | V0 ä½ç½® | V1 ä½ç½® | é›†æˆçŠ¶æ€ |
|------|---------|---------|----------|
| Agent æ ¸å¿ƒ | `agenthub/` | `software-agent-sdk/openhands-sdk/` | âœ… å·²é›†æˆ |
| LLM | `llm/` | `software-agent-sdk/openhands-sdk/llm/` | âœ… å·²é›†æˆ |
| Event | `events/` | `software-agent-sdk/openhands-sdk/event/` | âœ… å·²é›†æˆ |
| Tool | `runtime/` | `software-agent-sdk/openhands-tools/` | âœ… å·²é›†æˆ |
| Agent Server | N/A | `software-agent-sdk/openhands-agent-server/` | âœ… å·²é›†æˆ |
| Workspace | `runtime/` | `software-agent-sdk/openhands-workspace/` | âœ… å·²é›†æˆ |
| API Server | `server/` | `app_server/` | âœ… å·²é›†æˆ |
| å‰ç«¯ | `frontend/` | `frontend/` | ğŸ”„ é€‚é…ä¸­ |

### 7.5 V1 æ ¸å¿ƒä¼˜åŠ¿ (ç›¸æ¯” V0)

1. **æ¨¡å—åŒ–è®¾è®¡**: SDKã€Toolsã€Agent-Serverã€Workspace ç‹¬ç«‹å‘å¸ƒ
2. **æ›´å¥½çš„ç±»å‹æ”¯æŒ**: Python 3.12+ã€å®Œæ•´ç±»å‹æ³¨è§£
3. **äº‹ä»¶æº¯æº**: å®Œæ•´çš„äº‹ä»¶æº¯æºæ¶æ„ï¼ŒæŒä¹…åŒ–æ”¯æŒ
4. **æ›´å¥½çš„æ‰©å±•æ€§**: æ’ä»¶ç³»ç»Ÿã€Subagent æ”¯æŒ
5. **ç°ä»£åŒ–å·¥å…·**: æ”¹è¿›çš„ç»ˆç«¯ã€æ–‡ä»¶ç¼–è¾‘ã€æµè§ˆå™¨å·¥å…·
6. **æ€§èƒ½ä¼˜åŒ–**: å¼‚æ­¥æ¶æ„ã€æ›´å¥½çš„èµ„æºç®¡ç†

---

## å…«ã€æ€»ç»“

### V0 ä¼˜ç‚¹

- ä»£ç æˆç†Ÿç¨³å®š
- éƒ¨ç½²ç®€å•
- å¯åŠ¨é€Ÿåº¦å¿«

### V0 ç¼ºç‚¹

- å•ä½“æ¶æ„éš¾ä»¥æ‰©å±•
- æ–‡ä»¶å­˜å‚¨æ— äº‹åŠ¡
- Runtime ç´§è€¦åˆ
- äº‹ä»¶ç³»ç»Ÿå†…å­˜å—é™

### V1 æ”¹è¿›ç‚¹


| ç»´åº¦      | æ”¹è¿›å†…å®¹           |
| ------- | -------------- |
| **æ¶æ„**  | å¾®æœåŠ¡åŒ–ï¼Œç‹¬ç«‹æ‰©å±•      |
| **å­˜å‚¨**  | SQL æ•°æ®åº“ï¼Œæ”¯æŒäº‹åŠ¡   |
| **è¿è¡Œæ—¶** | Sandbox æ²™ç®±éš”ç¦»   |
| **äº‹ä»¶**  | æ•°æ®åº“æŒä¹…åŒ–ï¼Œåˆ†é¡µæŸ¥è¯¢    |
| **API** | RESTful è®¾è®¡ï¼Œç‰ˆæœ¬åŒ– |
| **å®‰å…¨**  | åŠ å¯†å­˜å‚¨ï¼Œå®‰å…¨è¯„ä¼°      |
| **åŠŸèƒ½**  | çˆ¶å­ä¼šè¯ï¼ŒåŠ¨æ€æŠ€èƒ½      |


### V1 å¾…å®Œæˆ

- Agent æ ¸å¿ƒ (Software Agent SDK) é›†æˆ
- å®Œå…¨ç§»é™¤ V0 ä»£ç 
- å‰åç«¯å…¨é¢åˆ‡æ¢åˆ° V1

---

## é™„å½•: ç›¸å…³é“¾æ¥

- **V1 Agentic Core (Software Agent SDK)**: [https://github.com/OpenHands/software-agent-sdk](https://github.com/OpenHands/software-agent-sdk)
  - æ ¸å¿ƒæ¨¡å—: `openhands-sdk/`
  - å·¥å…·é›†: `openhands-tools/`
  - AgentæœåŠ¡å™¨: `openhands-agent-server/`
  - å·¥ä½œç©ºé—´: `openhands-workspace/`
- V1 Application Server: `openhands/app_server/`
- ç§»é™¤è®¡åˆ’: 2026å¹´4æœˆ1æ—¥

